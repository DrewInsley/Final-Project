---
title: "Final Project"
author: "Drew Insley"
date: "12/04/18"
output: html_notebook
---

## Set Up

```{r message=FALSE, warning=FALSE}
library(DataComputing)
library(rvest)
library(lubridate)
library(tidyr)
```

## Project

```{r echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
# Get the Data
getwd()
setwd("~/Downloads")

FireIncidents <- read.csv("Fire_Incident_Dispatch_Data.csv")
```

```{r}
# Inspect the Data
str(FireIncidents)
```

```{r}
# Clean up the data
pattern <- ("[0-9]{2}[:][0-9]{2}[:][0-9]{2}")

FireIncidents <-
FireIncidents %>%
  select(INCIDENT_BOROUGH, INCIDENT_DATETIME, ENGINES_ASSIGNED_QUANTITY, INCIDENT_CLASSIFICATION_GROUP, ZIPCODE, LADDERS_ASSIGNED_QUANTITY) %>%
  rename(Borough = INCIDENT_BOROUGH, Date = INCIDENT_DATETIME, Engines = ENGINES_ASSIGNED_QUANTITY, Type = INCIDENT_CLASSIFICATION_GROUP, Ladders = LADDERS_ASSIGNED_QUANTITY, ZipCode = ZIPCODE) %>%
  mutate(Date = gsub(pattern, " ", Date)) %>%
  mutate(Date = gsub("[AMP]{2}", " ", Date)) %>%
  mutate(Date = mdy(Date))

FireIncidents
```

**Now we have a dataset we can use! Let's make a chart of counts for incidents and ladders by borough, so that we can graph these data!**

```{r}
# Make a chart of counts
FireCount <-
FireIncidents %>%
  group_by(Borough) %>%
  summarise(Incidents=n()) %>%
  arrange(desc(Incidents))

FireLadders <-
FireIncidents %>%
  group_by(Borough) %>%
  summarise(Ladders=sum(Ladders)) %>%
  arrange(desc(Ladders))


FireJoin <-
  FireCount %>%
  inner_join(FireLadders)

FireJoin
```



```{r}
# Which borough had the most number of fire incidents?
FireJoin %>%
  ggplot(aes(reorder(Borough, desc(Incidents)), Incidents)) +
  geom_bar(stat="identity", fill="blue", color="red", alpha=.2) +
  xlab("Borough")
```

**The graph shows the descending order of fire incidents in the five boroughs of New York. As one can see, Brooklyn had the most fire incidents with 777,725 occurances. Let's see if the number of ladders deployed by borough will match with the amount of incidents by borough.**

```{r}
# How many ladders were deployed?
FireJoin %>%
  ggplot(aes(reorder(Borough, desc(Ladders)), Ladders)) +
  geom_bar(stat="identity", fill="red", color="blue", alpha=.2) +
  xlab("Borough")
```

**The number of ladders deployed does match with the amount of fire incidents by borough. In fact, the descending order is the exact same. To further visualize this connection, we can plot ladders and incidents on a scatterplot.**

```{r}
# Plot ladders & incidents on a scatterplot
FireJoin %>%
  ggplot(aes(Ladders, Incidents)) +
  geom_point(shape=1, aes(color= Borough)) +
  geom_smooth(method=lm, se=FALSE)
```



**As the scatterplot shows, the population correlation, or rho, seems to be very close to 1. This means that ladders deployedand number of fires are heavily correlated. Let's see which days these fires were most likely to occur.**

```{r}
# What days were these fires most likely to occur?
FireDays <-
FireIncidents %>%
  group_by(Date) %>%
  summarise(Count=n()) %>%
  mutate(Rank = rank(desc(Count))) %>%
  select(Date, Rank) %>%
  arrange(Rank)

FireDays %>%
  head(5)
```

**Apparently people really like to start fires in February! In this case, the lower the rank, the higher the amount of fires. The 5 days with the most amounts of fires are all in the second month! However, we should look at which month had the most amount of medical emergencies, by creating a chart of months and fire types.**

```{r}
pattern <- ("[0-7]{4}[-]")

FireTypes <-
FireIncidents %>%
  select(Date, Type) %>%
  mutate(Month = gsub(pattern, " ", Date)) %>%
  mutate(Month = gsub(("[-][0-9]{2}"), " ", Date)) %>%
  group_by(Month, Type) %>%
  summarise(Count=n()) %>%
  filter(Type == 'Medical Emergencies') %>%
  arrange(desc(Count))

FireTypes
```

**Oddly enough, even though the top five worst fire days were in February, the second month actually has the least amount of medical emergencies associated with those fires! In fact, the most medical emergencies come from July, a completely different season.**








