---
title: "Final Project"
author: "Drew Insley"
date: "12/04/18"
output: html_notebook
---

## Set Up

```{r message=FALSE, warning=FALSE}
library(DataComputing)
library(rvest)
library(lubridate)
library(tidyr)
```

## Project

```{r echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
# Get the Data
getwd()
setwd("~/Downloads")

FireIncidents <- read.csv("Fire_Incident_Dispatch_Data.csv")
```

```{r}
# Inspect the Data
str(FireIncidents)
```

```{r}
# Clean up the data
pattern <- ("[0-9]{2}[:][0-9]{2}[:][0-9]{2}")

FireIncidents <-
FireIncidents %>%
  select(INCIDENT_BOROUGH, INCIDENT_DATETIME, ENGINES_ASSIGNED_QUANTITY, INCIDENT_CLASSIFICATION_GROUP, ZIPCODE, LADDERS_ASSIGNED_QUANTITY) %>%
  rename(Borough = INCIDENT_BOROUGH, Date = INCIDENT_DATETIME, Engines = ENGINES_ASSIGNED_QUANTITY, Type = INCIDENT_CLASSIFICATION_GROUP, Ladders = LADDERS_ASSIGNED_QUANTITY, ZipCode = ZIPCODE) %>%
  mutate(Date = gsub(pattern, " ", Date)) %>%
  mutate(Date = gsub("[AMP]{2}", " ", Date)) %>%
  mutate(Date = mdy(Date))

FireIncidents
```

```{r}
# Which borough had the most number of fire incidents?
FireCount <-
FireIncidents %>%
  group_by(Borough) %>%
  summarise(Count=n()) %>%
  arrange(desc(Count))

FireCount %>%
  ggplot(aes(reorder(Borough, desc(Count)), Count)) +
  geom_bar(stat="identity", fill="blue", color="red", alpha=.2) +
  xlab("Borough")
  
```

**The graph shows the descending order of fire incidents in the five boroughs of New York. As one can see, Brooklyn had the most fire incidents with 777,725 occurances. Let's see if the number of ladders deployed by borough will match with the amount of incidents by borough.**

```{r}
# How many ladders were deployed?
FireLadders <-
FireIncidents %>%
  group_by(Borough) %>%
  summarise(Count=sum(Ladders)) %>%
  arrange(desc(Count))

FireLadders %>%
  ggplot(aes(reorder(Borough, desc(Count)), Count)) +
  geom_bar(stat="identity", fill="red", color="blue", alpha=.2) +
  xlab("Borough")
  

```

**The number of ladders deployed does match with the amount of fire incidents by borough. In fact, the descending order is the exact same. Let's examine which days these incidents were most likely to occur.**

```{r}
FireDays <-
FireIncidents %>%
  group_by(Date) %>%
  summarise(Count=n()) %>%
  mutate(Rank = rank(desc(Count))) %>%
  select(Date, Rank) %>%
  arrange(Rank)

FireDays %>%
  head(5)
```

**Apparently people really like to start fires in February! In this case, the lower the rank, the higher the amount of fires. The 5 days with the most amounts of fires are all in the second month!**










